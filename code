import numpy as np
import networkx as nx

class QuantumGateNode:
    def __init__(self, node_id, state_vector=None):
        self.node_id = node_id
        self.state_vector = state_vector if state_vector is not None else np.array([1, 0])  # |0‚ü© state
        self.entangled_with = []

    def apply_gate(self, gate_matrix):
        self.state_vector = np.dot(gate_matrix, self.state_vector)

    def entangle(self, other_node):
        self.entangled_with.append(other_node.node_id)

class GateGrid:
    def __init__(self, size):
        self.graph = nx.grid_2d_graph(size, size)
        self.nodes = {}
        for node in self.graph.nodes:
            self.nodes[node] = QuantumGateNode(node)

    def apply_global_gate(self, gate_matrix):
        for node in self.nodes.values():
            node.apply_gate(gate_matrix)

    def entangle_neighbors(self):
        for node in self.graph.nodes:
            for neighbor in self.graph.neighbors(node):
                self.nodes[node].entangle(self.nodes[neighbor])